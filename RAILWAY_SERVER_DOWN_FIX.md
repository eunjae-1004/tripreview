# Railway 서버 다운 문제 해결 가이드

## 문제

Railway에서 "Application failed to respond" 에러가 발생합니다.

## 즉시 확인할 사항

### 1. Railway 대시보드에서 로그 확인

1. **Railway 대시보드 접속**
   - https://railway.app
   - `tripreview_backend` 프로젝트 선택

2. **Logs 탭 확인**
   - 왼쪽 메뉴에서 "Logs" 클릭
   - 최근 로그 확인

3. **에러 메시지 확인**
   - 다음 메시지가 있는지 확인:
     ```
     ✅ 서버가 포트 8080에서 실행 중입니다.
     ```
   - 에러 메시지가 있는지 확인:
     - `PostgreSQL 연결 오류`
     - `포트가 이미 사용 중입니다`
     - `메모리 부족`
     - `처리되지 않은 예외`

### 2. 서버 상태 확인

1. **Railway 대시보드 > 서비스 선택**
2. **상태 확인**
   - "Active" 상태인지 확인
   - "Stopped" 또는 "Failed" 상태면 문제 있음

3. **서버 재시작**
   - Settings > Restart 클릭
   - 또는 Deployments 탭에서 최신 배포 클릭 > Redeploy

## 일반적인 원인과 해결책

### 원인 1: 데이터베이스 연결 실패

**증상:**
- 로그에 "PostgreSQL 연결 오류" 메시지
- 서버가 시작 중에 크래시

**해결:**
1. Railway 대시보드 > Variables
2. `DATABASE_URL` 확인
3. PostgreSQL 서비스가 실행 중인지 확인
4. 필요시 PostgreSQL 서비스 재시작

### 원인 2: 환경 변수 누락

**증상:**
- 로그에 환경 변수 관련 에러
- 서버가 시작되지 않음

**해결:**
1. Railway 대시보드 > Variables
2. 다음 변수 확인:
   - `DATABASE_URL` (선택사항이지만 권장)
   - `ADMIN_PASSWORD` (필수)
   - `NODE_ENV` (선택, 기본값 사용 가능)
   - `PORT` (Railway가 자동 설정)

### 원인 3: 메모리 부족

**증상:**
- 로그에 "Out of memory" 에러
- 서버가 갑자기 종료됨

**해결:**
1. Railway 플랜 확인
2. 필요시 플랜 업그레이드
3. 또는 불필요한 프로세스 제거

### 원인 4: 포트 충돌

**증상:**
- 로그에 "포트가 이미 사용 중입니다" 에러

**해결:**
1. Railway가 자동으로 포트를 설정하므로 문제 없어야 함
2. 서버 재시작

## 서버 재시작 방법

### 방법 1: Railway 대시보드에서 재시작

1. Railway 대시보드 > 서비스 선택
2. Settings > Restart 클릭
3. 서버가 재시작될 때까지 대기

### 방법 2: 재배포

1. Railway 대시보드 > Deployments
2. 최신 배포 클릭
3. "Redeploy" 버튼 클릭

## 예방 조치

코드 레벨에서 이미 다음 조치를 취했습니다:

1. ✅ 데이터베이스 연결 실패 시에도 서버 계속 실행
2. ✅ 처리되지 않은 예외 로깅 (서버 종료 방지)
3. ✅ 에러 핸들링 개선

## 다음 단계

1. **Railway 로그 확인**
   - 정확한 에러 메시지 확인
   - 에러 발생 시점 확인

2. **서버 재시작**
   - Settings > Restart 클릭
   - 재시작 후 로그 확인

3. **문제가 계속되면**
   - Railway 지원팀에 문의
   - 로그와 에러 메시지 제공

## 디버깅 정보 수집

문제 해결을 위해 다음 정보를 수집하세요:

1. **Railway 로그**
   - 최근 100줄의 로그
   - 에러 메시지

2. **서버 상태**
   - Active/Stopped/Failed 상태
   - 마지막 재시작 시간

3. **환경 변수**
   - Variables 탭의 모든 변수 목록
   - (비밀번호는 제외)

4. **배포 정보**
   - 최신 배포 시간
   - 배포 상태 (Success/Failed)
